---
title: "CSIT165_Project2"
author: "Alex Yu and Audrey Lewis"
date: "12/19/2020"
output: html_document
urlcolor: blue
---

```{r Library, include=TRUE}
#for reading files
library(readr)
#install stringr
library(stringr)
#install dplyr
library(dplyr)
#install tidyr
library(tidyr)
#install magrittr
library(magrittr)
#install data table
library(data.table)
#install Kable
library(kableExtra)
#install for visualization
library(ggplot2)
#install for scaling by month on plot
library(scales)
#install for date function
library(lubridate)
#install tidyverse
library(tidyverse)
#map visual
library(maps)

knitr::opts_chunk$set(echo = TRUE)
```


```{r Files, include=TRUE}

#Reading files for confirmedGlobal
urlfile="https://raw.githubusercontent.com/CSSEGISandData/COVID-19/master/csse_covid_19_data/csse_covid_19_time_series/time_series_covid19_confirmed_global.csv"
confirmedGlobal<-read_csv(url(urlfile))

#Adding Deaths_Global
urlfile="https://raw.githubusercontent.com/CSSEGISandData/COVID-19/master/csse_covid_19_data/csse_covid_19_time_series/time_series_covid19_deaths_global.csv"
DeathsGlobal <-read_csv(url(urlfile))

#Adding Recovered_Global
urlfile="https://raw.githubusercontent.com/CSSEGISandData/COVID-19/master/csse_covid_19_data/csse_covid_19_time_series/time_series_covid19_recovered_global.csv"
RecoveredGlobal <-read_csv(url(urlfile))

```

# Objective 1 - Global Trajectory

Your first task as a CSIT-165 data scientist is to determine the global trajectory of COVID-19 as far as confirmed, recovers, and deaths are concerned.

Create three overlapped scatter plots for the global trajectory of COVID-19 for confirmations, recoveries, and deaths. This required that the cases for each date are summed for all countries and provinces in the data set. 

```{r Objective1, echo=TRUE}

#Sorting ConfirmedGlobal
confirmedGlobal_Sort <- confirmedGlobal %>% gather(key="date", value="confirmed", -c(`Country/Region`, `Province/State`, Lat, Long)) %>% group_by(`Country/Region`, date) %>% summarize(confirmed=sum(confirmed))

#Sorting DeathsGlobal
DeathsGlobal_Sort <- DeathsGlobal %>% gather(key="date", value="Deaths", -c(`Country/Region`, `Province/State`, Lat, Long)) %>% group_by(`Country/Region`, date) %>% summarize(Deaths=sum(Deaths))

#Sorting RecoveredGlobal
RecoveredGlobal_Sort <- RecoveredGlobal %>% gather(key="date", value="Recovered", -c(`Country/Region`, `Province/State`, Lat, Long)) %>% group_by(`Country/Region`, date) %>% summarize(Recovered=sum(Recovered))

#Combining Data to one
Combined_Data <- full_join(confirmedGlobal_Sort, DeathsGlobal_Sort) %>% full_join(RecoveredGlobal_Sort)


#ggplot(Combined_Data, aes('Country/Region`,value)) + 
  #geom_point() + 
  #stat_smooth() +
  #facet_wrap(~variable)

#Combined_Data %>%
#ggplot(aes(x = date, y = confirmed)) +
      #geom_point(color = "darkorchid4") +
      #labs(title = "Confirmed Plot",
           #y = "confirmed",
           #x = "date") + theme_bw(base_size = 10)

```

# Objective 2 - Global Map

After realizing the vastness of the spread of COVID-19 from your global trajectory you are then asked to create a world map to gain an appreciation for where the most occurrences are.

Create this map using leaflet for the most recent date as shown below. Notice that hover labels show the province when the data is available and show the country when it is not. Also notice that the popup labels are customized to the data that is being clicked on. For extra help using leaflet, please consult this website along with the information provided in your textbooks.

```{r Objective2, echo=TRUE}
#Creating map
mapWorld <- borders("world", colour = "gray50", fill = "gray50")

#Creating map plot -NO DATA YET
map <- ggplot() + mapWorld

#See the map
map


```

# Objective 3 - Narrowing Down Hot Spots
Seeing the global map of COVID-19 cases results in the stark realization that some countries are more affected than others. In order to narrow down your studies, create a table using kable from knitr listing the top countries as far as confirmations, recoveries, and deaths. Now that we are using RMarkdown to create HTML files, we have much more options for how we display our table. For reference on how to customize tables using knitr, visit this website. Consult the table below for an example of a customized table ranking cases by country. While it is not required to replicate this table exactly, it would be a fantastic challenge to show off your knitr prowess.

```{r Objective3, echo=TRUE}
#Building Top 10 confirmed for table
Top10Confirmed <- select(confirmedGlobal, `Country/Region`, `12/18/20`) %>% group_by(`Country/Region`) %>% mutate(confirmed=sum(`12/18/20`)) %>% arrange(-confirmed) %>% select(-`12/18/20`) %>% distinct() %>% head(10)

#Building Top 10 Deaths for table
Top10Deaths <- select(DeathsGlobal, `Country/Region`, `12/18/20`) %>% group_by(`Country/Region`) %>% mutate(Deaths=sum(`12/18/20`)) %>% arrange(-Deaths) %>% select(-`12/18/20`) %>% distinct() %>% head(10)

#Building Top 10 Recovered for table
Top10Recovered <- select(RecoveredGlobal, `Country/Region`, `12/18/20`) %>% group_by(`Country/Region`) %>% mutate(Recovered=sum(`12/18/20`)) %>% arrange(-Recovered) %>% select(-`12/18/20`) %>% distinct() %>% head(10)

#Merged the 3 tables together
MergedData <-full_join(Top10Confirmed, Top10Deaths) %>% full_join(Top10Recovered)

#Creating table using kbl
kbl(MergedData) %>%
  kable_classic() %>%
add_header_above(c(" ", "confirmed" = 1, "Deaths" = 1, "Recovered" = 1))
```


# Objective 4 - Zooming Into California

<!-- assigned to Alex -->
<!-- enter code here -->


# Objective 5 - Digging Deeper

<!-- assigned to Alex -->
<!-- enter code here -->




<!-- commenting this out until submission
     since it throws an error -->

<!-- ```{bash }
# commenting this out until submission
# since it throws an error
#
# git log --pretty=format:"%nSubject: %s%nAuthor: %aN%nDate: %aD%nBody: %b"

``` -->
